###############################################################################
# Common
###############################################################################
daemonize: false

###############################################################################
# Exporter: pmacctd + nfprobe (sniff NIC -> export IPFIX)
###############################################################################
pcap_interface: eth0

# 五元组 + tos（不要加 timestamp_*）
aggregate: src_host, dst_host, src_port, dst_port, proto, tos, tcpflags

plugins: nfprobe
nfprobe_receiver: 127.0.0.1:9995
nfprobe_version: 10
nfprobe_timeouts: tcp=30:maxlife=60

###############################################################################
# Collector: nfacctd + print (listen IPFIX -> print CSV)
###############################################################################
nfacctd_ip: 0.0.0.0
nfacctd_port: 9995

# 注意：nfacctd 也会看 plugins/aggregate/print_* 这些项
# 所以如果你希望 collector 和 exporter 的 aggregate 不一样，
# 就需要拆文件；否则用同一个 aggregate 最省事。

print_output: csv
print_refresh_time: 1
timestamps_since_epoch: true

# 想让输出带近似“起止时间”，可以开 stitching（会多 timestamp_min/max）
nfacctd_stitching: true

###############################################################################
# Processor 配置（按需修改；建议保持注释，避免 pmacct 报未知配置）
###############################################################################
processor_ftp_host: 10.0.0.10
processor_ftp_port: 21
processor_ftp_user: ftpuser
processor_ftp_pass: ftppass
processor_ftp_dir: /
#
processor_rotate_interval_sec: 60
processor_rotate_size_mb: 100
processor_file_prefix: flows_
#
processor_upload_interval_sec: 60
processor_timezone: Asia/Shanghai
#
processor_status_report_enabled: false
processor_status_report_url: http://127.0.0.1:8080/api/uploadStatus
processor_status_report_interval_sec: 60
processor_status_report_uuid:
processor_status_report_file_path:
processor_status_report_file_max_mb: 10
processor_status_report_file_backups: 0
